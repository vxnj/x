<!DOCTYPE html>
<meta charset="UTF-8">
<html>
<head>
<title>Page Title</title>
</head>


<meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1">

<script src="js/funcs.js"></script>
<script src="js/fDate.js"></script>
<link rel="stylesheet" href="style.css" />

<script>

var xhr = new XMLHttpRequest();
xhr.onreadystatechange = function() { // Check if fetch request is done
    if (xhr.readyState == 4 && xhr.status == 200) { 
        jsonData = JSON.parse(xhr.responseText);
        processQ(jsonData);
    }
}

let  resp = 'a';
data = "";

function getQ() {
  now = date_format(new Date(), 'U');
  console.log(now);
  prx = "https://api.allorigins.win/raw?url=";
  url = "https://query1.finance.yahoo.com/v7/finance/quote?symbols=^ixic,^DJI,^SPX,aapl,hsbc,ibm,tsla,BTC-USD,ETH-USD" + ',X' + now
  xhr.open("GET", prx + url, true);
  xhr.send();
}

function processQ(data) {
  console.log('processQ start');
  // console.log(data.quoteResponse.result.length);
  for (q = 0, len =data.quoteResponse.result.length, vres = ""; q < len; q++) {
    vres += data.quoteResponse.result[q].regularMarketTime+' '   +data.quoteResponse.result[q].symbol + ' ' +  data.quoteResponse.result[q].regularMarketPrice + '<br>'
  }
  document.getElementById("app1").innerHTML = vres ;
  console.log(vres || 'dang');

  
}

</script>


<body>
  <p ></p>
    <button id="get" onclick="getQ()">GET</button><br><br>
    <div style="color:rgb(20, 209, 67) !important" id="app1">1</div><br>
    <div id="app2">2</div><br>
    <div id="app3">3</div><br>
    <div id="app4" style="max-width: 100%;">4</div><br>
    <div id="aqii" class="numball">99</div><br>
    
</body>
</html>
    